{% extends 'base.html' %} {% block content %} Welcome to my first Python
Project!

<div id="posts">
  Loading...
</div>

<script>
  const postsElement = document.getElementById('posts');
  // postsElement.innerHTML = 'Loading...';

  const xhr = new XMLHttpRequest();
  const method = 'GET';
  const url = '/posts';
  const responseType = 'json';

  const LikeBtn = (post) => {
    return (
      "<button class='btn btn-primary btn-small' onClick=handleLike(" +
      post.id +
      ',' +
      post.likes +
      ')>' +
      post.likes +
      ' Likes</button>'
    );
  };

  const handleLike = (post_id, currentCount) => {
    console.log(post_id, currentCount);
    return;
  };

  // const formatPostElement = (post) => {

  // }

  xhr.responseType = responseType;
  xhr.open(method, url);
  xhr.onload = () => {
    const serverResponse = xhr.response;
    const listedItems = serverResponse.response;

    const finalPostStr = listedItems.map((listedItem) => {
      return (
        "<div class='mb-4 home__post' id='post__" +
        listedItem.id +
        "'><p>" +
        listedItem.content +
        "</p><div class='btn-group'>" +
        LikeBtn(listedItem) +
        '</div></div>'
      );
    });

    postsElement.innerHTML = finalPostStr;
  };
  xhr.send();
</script>
{% endblock content %}
